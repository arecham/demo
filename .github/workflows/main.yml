---
name: Deploy to Kubernetes via Argo CD
on:
  push:
    branches:
      - main
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4  # ← v2 obsolète, v4 stable
      - name: Install yamllint
        run: pipx install yamllint  # ← yamllint manquant sur ubuntu-latest
      - name: Validate YAML manifests
        run: yamllint k8s/  # ← Valide vos manifests k8s/ corrigés
      - name: Notify Argo CD sync
        run: echo "✅ Changes pushed to main. Argo CD auto-syncs k8s/ path."
